<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>06.fetch í”„ë¼ë¯¸ìŠ¤</title>
  </head>
  <body>
    <!-- ì¶œë ¥ë°•ìŠ¤ -->
    <h3 class="exp"></h3>

    <script>
      // ë°ì´í„°ë¥¼ ë‹¤ë¥¸ì„œë²„ì—ì„œ ê°€ì ¸ì˜¬ ê²½ìš°
      // ê°™ì€ ì„œë²„ì— ìœ„ì¹˜í•œ íŒŒì¼ë³´ë‹¤ ì‹œê°„ì´ ë”
      // ê±¸ë¦´ ìˆ˜ ìˆë‹¤!
      // ì´ë•Œ ê·¸ ì „ì†¡íŒŒì¼ì„ ì´ìš©í•œ ì²˜ë¦¬ì½”ë“œê°€
      // ì—ëŸ¬ë¥¼ ë‚˜íƒ€ë‚¼ í™•ìœ¨ì´ ë†’ì•„ì§„ë‹¤!
      // ì´ë•Œ Promiseë¥¼ ì‚¬ìš©í•˜ë©´ ë˜ê² ë‹¤!
      // ë” ì‰¬ìš´ Promiseê°€ fetch APIë‹¤!

      // ì°¸ê³ : w3schools
      // -> https://www.w3schools.com/js/js_api_fetch.asp

      /* 
        [ fetch APIë€? ]
        Fetch API ì¸í„°í˜ì´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ë©´ ì›¹ ë¸Œë¼ìš°ì €ê°€ 
        ì›¹ ì„œë²„ì— HTTP ìš”ì²­ì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        ğŸ˜€ ë” ì´ìƒ XMLHttpRequestê°€ í•„ìš”í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

        - [ì‚¬ìš©ë²•1:]

        ë‚˜ë³€ìˆ˜ = ì›¹ìƒíŒŒì¼ì£¼ì†Œ;

        fetch(ë‚˜ë³€ìˆ˜) // ì›¹ìƒíŒŒì¼ë¡œë“œ
        .then(x=>x.text()) // ë¡œë“œí›„ í…ŒìŠ¤íŠ¸ ì½ê¸°
        .then(y=> ëª…ë ¹ì–´ì‚¬ìš©) // í…ìŠ¤íŠ¸ì½ì€ í›„ ì–´ë–¤ì½”ë“œì‹¤í–‰

        - [ì‚¬ìš©ë²•2:]

        ë‚˜ë³€ìˆ˜ = ì›¹ìƒíŒŒì¼ì£¼ì†Œ;

        // async í•¨ìˆ˜ë§Œë“¤ê¸°
        async function ë¹„ë™ê¸°í•¨ìˆ˜(ë‚˜ë³€ìˆ˜){
            ë³€ìˆ˜1 = await fetch(ë‚˜ë³€ìˆ˜); // fetch() ê¸°ë‹¤ë¦¼
            ë³€ìˆ˜2 = await ë³€ìˆ˜1.text(); // text() ê¸°ë‹¤ë¦¼
            í•˜ê³ ì‹¶ì€ì½”ë“œ..... // ìœ„ì˜ ì½”ë“œê°€ ì™„ë£Œëœ í›„ ì‹¤í–‰í•¨
        } ////// ë¹„ë™ê¸°í•¨ìˆ˜ /////////

        // ì ì ˆí•œ ê³³ì—ì„œ ë¹„ë™ê¸°í•¨ìˆ˜ í˜¸ì¶œ
        ë¹„ë™ê¸°í•¨ìˆ˜(ë‚˜ë³€ìˆ˜);


    */

      // ì›¹ì— ê³µê°œëœ í…ìŠ¤íŠ¸ íŒŒì¼
      let file =
        "https://tombap8.github.io/FED-RF-2023-TOM/500.%ED%95%84%EA%B8%B0%EB%AA%A8%EC%9D%8C/013.DOM%EC%9D%B4%EB%9E%80.txt";

      // ë³€í™˜ì—†ì´ í™”ë©´ì— ì¶œë ¥í•˜ê¸° -> ì‹¤ì œíŒŒì¼ì€ ê°€ì ¸ì˜¤ì§€ ëª»í•¨!
      // document.querySelector('.exp').innerHTML = file;

      const tg = document.querySelector(".exp");

      // ì›¹ ì£¼ì†Œì˜ íŒŒì¼ì„ fetch í•˜ê¸° -> ì‹¤ì œíŒŒì¼ ê°€ì ¸ì˜¤ê¸°
      fetch(file)
        .then((x) => x.text()) // ê°€ì ¸ì˜¨ í›„ ë‚´ìš©ì½ê¸°!
        .then((x) => (tg.innerHTML = x));
      // ë‚´ìš©ì½ê¸° í›„ í™”ë©´ì— ë¿Œë¦¼!

      // í…ŒìŠ¤íŠ¸2 - ì œì´ìŠ¨íŒŒì¼
      let file2 =
        "https://tombap8.github.io/FED-PJ-2022-tom/004.JS%ED%95%99%EC%8A%B5/JS%EB%B9%84%EB%8F%99%EA%B8%B0/defaultSettings.json";

      // asyncí•¨ìˆ˜ ë§Œë“¤ê¸°
      async function getFile(fData) {
        // 1. íŒŒì¼ ë¡œë“œê¹Œì§€ ê¸°ë‹¤ë ¤~
        let myFetch = await fetch(fData);
        // 2. ë¡œë“œëœ íŒŒì¼ ë‚´ìš© ì½ì„ë•Œê¹Œì§€ ê¸°ë‹¤ë ¤~
        let myText = await myFetch.text();

        // 3. ìœ„ì˜ 1,2ë²ˆ ìˆœì„œëŒ€ë¡œ ì™„ë£Œ í›„ ì¶œë ¥í•˜ê¸°
        tg.innerHTML += myText;
      } /////////// async í•¨ìˆ˜ ////////////////

      // ë¹„ë™ê¸° í•¨ìˆ˜ í˜¸ì¶œ!!!
      getFile(file2);
    </script>
  </body>
</html>
