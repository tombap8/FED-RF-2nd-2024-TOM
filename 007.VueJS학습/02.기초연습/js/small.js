// ì‡¼í•‘ëª° ê°¤ëŸ¬ë¦¬ JS - small.js

// í…œí”Œë¦¿ htmlì½”ë“œ ê°ì²´ JS ê°€ì ¸ì˜¤ê¸°
import hcode from "./hcode.js";

// ë·°JS ì¸ìŠ¤í„´ìŠ¤ ìƒì„±ìš© í•¨ìˆ˜!
const makeVue = (x) => new Vue({ el: x });

// 1. ì œëª©ì— ë„£ì„ ì „ì—­ì»´í¬ë„ŒíŠ¸ ë§Œë“¤ê¸°
Vue.component('tit-comp',{
    // 1-1. í…œí”Œë¦¿ ì…‹íŒ…
    template: hcode.tit,
}); ///// ì „ì—­ ì»´í¬ë„ŒíŠ¸ 1 /////////

// ë·°ì¸ìŠ¤í„´ìŠ¤ ìƒì„±í•˜ê¸°
makeVue('.tit');

// ì´ë¯¸ì§€ë²ˆí˜¸ ìˆ«ìì¦ê° ë³€ìˆ˜
let inum = 0;

// ì„¸ì¼ê°€ê²© ê³„ì‚°ì„ ìœ„í•œ ì„ì‹œë³€ìˆ˜
let temp;

// ìƒí’ˆëª… ë°°ì—´
const goods = ["í”„ë ˆì´ì»·", "ì•„ì¼ë ›ê¸°ëª¨", "ë² ì–´ë¶€í´", "í¬ë©€ë¯¹ìŠ¤í†¤"];

// 2. ê°¤ëŸ¬ë¦¬ ë¦¬ìŠ¤íŠ¸ì— ë„£ì„ ì „ì—­ ì»´í¬ë„ŒíŠ¸ ë§Œë“¤ê¸°
// ->>> ìì‹ì»´í¬ë„ŒíŠ¸!!!
Vue.component("list-comp", {
  // 2-1. template ì˜µì…˜ : íƒœê·¸êµ¬ì„±
  // srcì†ì„±ì„ ì…‹íŒ…ëœ ë³€ìˆ˜ë¥¼ ì ìš©í•˜ê¸°ìœ„í•´
  // ì†ì„±ì•ì— v-bind:ì„ ë¶™ì—¬ì„œ v-bind:src
  // ë¡œì“°ë©´ ê°’ìœ¼ë¡œ ë¬¸ìí˜•ì„ ì¨ë„ ê·¸ ì•ˆì˜
  // ê°’ì€ ë³€ìˆ˜ê°€ ëœë‹¤!!!(ì¤‘ìš”!!!)
  template: hcode.list,
// 2-2. props ì˜µì…˜ : 
// -> ë¶€ëª¨ ì¸ìŠ¤í„´ìŠ¤ìš”ì†Œì—ì„œ v-bind:ì†ì„±ëª…=ê°’ ìœ¼ë¡œ
// ì „ë‹¬í•œ ì†ì„±ë³€ìˆ˜ë¥¼ ë°›ëŠ” ì˜µì…˜
// ì‚¬ìš©ë²• ->>> props: []/{} ë¡œ ë°›ìŒ
// [] ë°°ì—´ë¡œ ë°›ìœ¼ë©´ ë³€ìˆ˜ë§Œ ì“°ê³ 
// {} ê°ì²´ë¡œ ë°›ìœ¼ë©´ ë³€ìˆ˜ë¥¼ ì†ì„±ì—, ê°’ì€ ë°ì´í„°í˜•ì„ ì”€
props:['data-num','my-seq','end-let'],
// props:{'data-num':Number}, -> ë°ì´í„°í˜• ì¼ì¹˜
// props:{'data-num':String}, -> ë°ì´í„°í˜• ë¶ˆì¼ì¹˜ë¡œ ì—ëŸ¬ë°œìƒ

// propsë¡œ ì…‹íŒ…í•œ ë¶€ëª¨ì „ë‹¬ ì†ì„±ì„ thisí‚¤ì›Œë“œì™€ í•¨ê»˜
// ë³€ìˆ˜í˜•ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì€??? ìºë¯ˆì¼€ì´ìŠ¤ë¡œ ë³€í™˜ì‚¬ìš©!
// 'data-num' -> this.dataNum 


  // 2-3. data ì˜µì…˜ : ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ ë³€ìˆ˜ì…‹íŒ…
  // ì‹¤í–‰ì›ë¦¬: ì»´í¬ë„ŒíŠ¸ê°€ ë¹Œë“œí• ë•Œ
  // dataì†ì„±ì˜ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•œë‹¤!
  // ê·¸ë˜ì„œ ë¦¬í„´ë˜ëŠ” ê°ì²´ê°’ì´ ì»´í¬ë„ŒíŠ¸ë‚´ë¶€ì—
  // ì „ë‹¬ëœë‹¤!!!
  data () {
    // í…œí”Œë¦¿ì—ì„œ ì‚¬ìš©í•  ë³€ìˆ˜ëŠ” ë°˜ë“œì‹œ ë¦¬í„´í•¨!
    // ì†ì„±:ê°’ìœ¼ë¡œ êµ¬ì„±ëœ ê°ì²´ë¥¼ ë¦¬í„´í•œë‹¤!
    return {
      // 1.ì´ë¯¸ì§€ src
      gsrc: `images/${this.dataNum}.jpg`,
      // 2.ìƒí’ˆëª… : data-num ê°’ì´ ì§ìˆ˜/í™€ìˆ˜ì— ë”°ë¼ ì•„ì´ì½˜ë³€ê²½
      gname: 'DE-'+this.setName()+this.endLet
      +(this.dataNum%2?"ğŸ˜˜":"ğŸ‘"),
      // 3.ìƒí’ˆê°€ê²©
      gprice: this.setPrice(),
      // 4.ì„¸ì¼ê°€ê²© : ìƒí’ˆì›ë˜ê°€ê²©ì˜ 30%ì„¸ì¼(ì›ê°€ê²©*0.7) 
      // -> ì™¸ë¶€ì˜ ì „ì—­ë³€ìˆ˜tempì— ì›ê°€ê²©ìˆìŒ!
      salePrice: (temp*0.7).toFixed(0),
      // ìˆ«ì.toFixed(ìë¦¿ìˆ˜) -> ì†Œìˆ˜ì  ì•„ë˜ ìë¦¬
    };
  },
  // 2-4. methods ì†ì„± : ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ ë©”ì„œë“œ ì…‹íŒ…
  methods: {
    // ìì‹ ë©”ì„œë“œì—ì„œ ë¶€ëª¨ë©”ì„œë“œë¥¼ í˜¸ì¶œí•œë‹¤!
    goPapa(txt){
      // this.$emit(ë¶€ëª¨ì´ë²¤íŠ¸ëª…,ì „ë‹¬ê°’)
      // ë¶€ëª¨ê°€ ë§Œë“ ì´ë²¤íŠ¸ëª…ì€ ì—¬ê¸°ì„œ hull
      this.$emit('hull',txt);
      // ê³¼ì •: ìì‹ì´ë²¤íŠ¸ì¸ 'click'ì´ë²¤íŠ¸ê°€
      // ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ì— ì…‹íŒ…ëœ 'hull'ì´ë²¤íŠ¸ë¡œ
      // ì „ë‹¬ë˜ì–´ ê±°ê¸°ì—°ê²°ëœ í•¨ìˆ˜ê°€ ì‹¤í–‰ëœë‹¤!
    },
    goMama(pm){ // pm - ì „ë‹¬ë³€ìˆ˜
      // this.$emit(ë¶€ëª¨ì´ë²¤íŠ¸ëª…,ì „ë‹¬ê°’)
      // ë¶€ëª¨ê°€ ë§Œë“ ì´ë²¤íŠ¸ëª…ì€ ì—¬ê¸°ì„œ hull
      this.$emit('got-kimchi',pm);
      // ê³¼ì •: ìì‹ì´ë²¤íŠ¸ì¸ 'click'ì´ë²¤íŠ¸ê°€
      // ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ì— ì…‹íŒ…ëœ 'hull'ì´ë²¤íŠ¸ë¡œ
      // ì „ë‹¬ë˜ì–´ ê±°ê¸°ì—°ê²°ëœ í•¨ìˆ˜ê°€ ì‹¤í–‰ëœë‹¤!
    },
    // ì´ë¯¸ì§€ë²ˆí˜¸ ë§Œë“¤ê¸° í•¨ìˆ˜
    // inumì„ 1ì”©ì¦ê°€í•˜ì—¬ ë¦¬í„´í•¨
    setNum() {
      inum += 1;
      // console.log("num:", inum);
      return inum;
    },
    // ìƒí’ˆëª… ë§Œë“¤ê¸° í•¨ìˆ˜
    setName() {
      // 0~3 ì‚¬ì´ë‚œìˆ˜
      let rdm = Math.floor(Math.random() * 4);
      // ì´ë¦„ë¦¬í„´
      return goods[rdm];
    },
    // ê°€ê²©ë§Œë“¤ê¸° í•¨ìˆ˜ : ìˆ«ìë§Œ ë§Œë“¤ì–´ì„œ ë¦¬í„´
    setPrice() {
      let rdm = Math.ceil(Math.random() * 17) + 3;
      let retVal = 20000 * rdm;
      // ì„¸ì¼ê°€ê²© ê³„ì‚°ì„ ìœ„í•œ ì„ì‹œë³€ìˆ˜ì— í• ë‹¹í›„ ë¦¬í„´
      temp = retVal;
      return retVal;
    },
    // ì„¸ì¼ì—¬ë¶€ ë¦¬í„´ ë©”ì„œë“œ
    retSale(){
      return(
        this.dataNum == 3 ||
        this.dataNum == 5 ||
        this.dataNum == 14 ||
        this.dataNum == 22 ||
        this.dataNum == 26 ||
        this.dataNum == 38 ||
        this.dataNum == 45 ||
        this.dataNum == 50
      );
    },
    // ì„¸ìë¦¬ì½¤ë§ˆ í•¨ìˆ˜
    addCommas(x) {
      return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    },
  },
}); ////////// ì „ì—­ì»´í¬ë„ŒíŠ¸2 /////////////


// ë¦¬ìŠ¤íŠ¸ë·° ì¸ìŠ¤í„´ìŠ¤ ìƒì„±í•˜ê¸°
// makeVue(".grid");
// [ ë¶€ëª¨ì»´í¬ë„ŒíŠ¸ì—ì„œ ë©”ì„œë“œ ì„¤ì •ìœ¼ë¡œ í•´ì•¼
// ìì‹ì»´í¬ë„ŒíŠ¸ê°€ í˜¸ì¶œí•  ìˆ˜ ìˆëŠ” ë©”ì„œë“œë¥¼ ë§Œë“¤ì–´ì§! ]
// ->>> ë¶€ëª¨ì»´í¬ë„ŒíŠ¸ !!!
new Vue({
  el:'.grid',
  // ë¶€ëª¨ ë·° ì¸ìŠ¤í„´ìŠ¤ ë©”ì„œë“œêµ¬ì—­
  methods:{
    // ìì‹ ì´ë²¤íŠ¸ ì „ë‹¬í›„ ì‹¤í–‰ë©”ì„œë“œ!
    goMsg(txt){
      alert('ìì‹ì´ ë¶€ëª¨ì—ê²Œ ì´ë²¤íŠ¸ ì „ë‹¬ ì„±ê³µ!!!'+txt);
    },
    // ìì‹ ì»´í¬ë„ŒíŠ¸ì˜ ì˜¤ë²„ì´ë²¤íŠ¸ê°€ ì „ë‹¬ë˜ì–´ 
    // í˜¸ì¶œí•˜ëŠ” í•¨ìˆ˜
    overMsg(pm){ // pm - ì „ë‹¬ë³€ìˆ˜
      alert('ì˜¤ ë§ˆì´ ê°“ê¹€ì¹˜!'+pm.ì´ë¦„+' ë‚˜ì´ëŠ” '+pm.ë‚˜ì´);
    },
  },
});


/////////// ìƒí’ˆìƒì„¸ì •ë³´ ì»´í¬ë„ŒíŠ¸ ////////////
Vue.component('win-comp',{
  template: hcode.detail,
}); ////////// win-comp ì»´í¬ë„ŒíŠ¸ ///////////

///// win-comp ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ ë·°ì¸ìŠ¤í„´ìŠ¤ ìƒì„±í•˜ê¸° /////
new Vue({
  // ëŒ€ìƒì„ ì •
  el: ".pbg",
  // DOMì´ ëª¨ë‘ ë¡œë”©í›„ ì‹¤í–‰êµ¬ì—­(ë¦¬ì•¡íŠ¸ì˜ useLayoutEffectì™€ ìœ ì‚¬í•¨)
  mounted(){
    // ì œì´ì¿¼ë¦¬ ì½”ë“œë¥¼ ì‚¬ìš©ê°€ëŠ¥!

    // ì›ë˜ê°€ê²©ë³€ìˆ˜ : ê° ë¦¬ìŠ¤íŠ¸ ì•„ì´í…œ í´ë¦­ìˆœê°„ ì…‹íŒ…
    let orgPrice;

    // í˜„ì¬ë¦¬ìŠ¤íŠ¸ ìˆœë²ˆ : ì–‘ìª½ ì´ë™ë²„íŠ¼ì—ì„œ ì‚¬ìš©
    let cIdx;


    // 1. ê°¤ëŸ¬ë¦¬ ë¦¬ìŠ¤íŠ¸ í´ë¦­ì‹œ í° ì´ë¯¸ì§€ë°•ìŠ¤ ë³´ì´ê¸°
    $(".grid>div").on('click',function(){
      // console.log('ëŒ€ìƒ:',this);

      // í˜„ì¬ë¦¬ìŠ¤íŠ¸ ìˆœë²ˆ ì…‹íŒ…í•˜ê¸°
      cIdx = $(this).index();
      console.log('í´ë¦­ëœë¦¬ìŠ¤íŠ¸ìˆœë²ˆ:',cIdx);

      // í´ë¦­ëœ ì´ë¯¸ì§€ ê²½ë¡œ ì½ì–´ì˜¤ê¸°
      let isrc = $(this).find('img').attr('src');
      console.log('ì´ë¯¸ì§€ê²½ë¡œ:',isrc);

      // ìƒì„¸ì •ë³´ì°½ í° ì´ë¯¸ì§€ ë³€ê²½í•˜ê¸°
      $('.gimg img').attr('src',isrc);

      // ìƒí’ˆëª… ì½ì–´ì˜¤ê¸°
      let cName = $('aside h2',this).html();
      // ìƒí’ˆëª… ë„£ê¸°
      $('#gtit').html(cName);

      // ê°€ê²© ì½ì–´ì˜¤ê¸°
      let cprice = $('aside h3',this).html();
      // ê°€ê²© ë„£ê¸°
      $('#gprice').html(cprice);
      
      // ìµœì´ˆ ê°€ê²© ì´í•©ê³„ ë„£ê¸°
      let tprice = 
      $('aside h3 span:last-child',this).html();
      $('#total').html(tprice);
      
    
      // ì›ë˜ê°€ê²© ì…‹íŒ…í•˜ê¸°: 'ì›',',' ëª¨ë‘ ì—†ì•°!
      orgPrice = Number(tprice.replace('ì›','').replace(/,/g,''));
      console.log('ì›ë˜ê°€ê²©:',orgPrice);
      // ë¬¸ìì—´.replace(ë°”ê¿€ë†ˆ, ë°”ë€”ë†ˆ)


      // ìƒí’ˆìƒì„¸ì •ë³´ì°½ ë³´ì´ê¸°
      $('#bgbx').show();

      // ê°œìˆ˜ ì´ˆê¸°í™”
      sum.val('1');

    }); ////////// click ///////////

    // ê°œìˆ˜ëŒ€ìƒ
    const sum = $("#sum");

    // ì¦ê°ë²„íŠ¼ ì…‹íŒ… ////
    $('.chg_num img').click(function(){
        // í´ë¦­ëœ ì¦ê° ì´ë¯¸ì§€ ìˆœë²ˆ
        let idx = $(this).index();
        console.log('ìˆœë²ˆ:',idx);
        

        // í˜„ì¬ ê°œìˆ˜
        let num = Number(sum.val());

        // ë°˜ì˜ë  ë³€ê²½ìˆ˜
        let setNum;

        // ì¦ê°ë¶„ê¸°
        if(idx===0){ // ì¦ê°€
          setNum = ++num;          
          if(setNum>50){ setNum=50;num=50;}
        }
        else{
          setNum = --num;
          if(setNum<1){ setNum=1;num=1;}
        } /// else ///

        // ìµœì¢…ë°˜ì˜í•˜ê¸°        
        sum.val(setNum);
        $('#total').html(
          addCommas(orgPrice*setNum)+"ì›");
    })

    // ë‹«ê¸°ë²„íŠ¼ ì…‹íŒ…
    $('.cbtn').click((e)=>{
      e.preventDefault();
      $('#bgbx').hide()});

      // ì„¸ìë¦¬ì½¤ë§ˆ í•¨ìˆ˜
    const addCommas = (x) => {
      return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    }

    // ì´ì „/ë‹¤ìŒ ë²„íŠ¼ ì…‹íŒ…í•˜ê¸°
    // ëŒ€ìƒ: .abtn
    $('.abtn').click(function(e){
      e.preventDefault();

      // ì˜¤ë¥¸ìª½ ë²„íŠ¼ì´ë©´ true
      let isR = $(this).is('.rb');
      
      // ë°©í–¥ë¶„ê¸° ////
      if(isR){ // ì˜¤ë¥¸ìª½
        // ë‹¤ìŒìˆœë²ˆ
        ++cIdx;
        if(cIdx>49) cIdx=0;
      }
      else{ // ì™¼ìª½
        --cIdx;
        if(cIdx<0) cIdx=49;
      }

      // ì •ë³´ íƒ€ê²Ÿìš”ì†Œ(ë¦¬ìŠ¤íŠ¸ ìˆœë²ˆìœ¼ë¡œ ê°€ì ¸ì˜´)
      const target = $('.grid>div').eq(cIdx);
      console.log('cIdx:',cIdx,'/íƒ€ê²Ÿ:',target);

      // ì²˜ìŒ ë¦¬ìŠ¤íŠ¸ í´ë¦­í•˜ì—¬ ì—´ë•Œ ì…‹íŒ…í•œ ê²ƒë“¤ì„
      // ëª¨ë‘ ë‹¤ì‹œ ì…‹íŒ…í•œë‹¤! ë‹¨, ì£¼ì¸ê³µì´ target!!!

      // íƒ€ê²Ÿ ì´ë¯¸ì§€ ê²½ë¡œ ì½ì–´ì˜¤ê¸°
      let isrc = target.find('img').attr('src');
      console.log('ì´ë¯¸ì§€ê²½ë¡œ:',isrc);

      // ìƒì„¸ì •ë³´ì°½ í° ì´ë¯¸ì§€ ë³€ê²½í•˜ê¸°
      $('.gimg img').attr('src',isrc);

      // ìƒí’ˆëª… ì½ì–´ì˜¤ê¸°
      let cName = $('aside h2',target).html();
      // ìƒí’ˆëª… ë„£ê¸°
      $('#gtit').html(cName);

      // ê°€ê²© ì½ì–´ì˜¤ê¸°
      let cprice = $('aside h3',target).html();
      // ê°€ê²© ë„£ê¸°
      $('#gprice').html(cprice);
      
      // ìµœì´ˆ ê°€ê²© ì´í•©ê³„ ë„£ê¸°
      let tprice = 
      $('aside h3 span:last-child',target).html();
      $('#total').html(tprice);
      
    
      // ì›ë˜ê°€ê²© ì…‹íŒ…í•˜ê¸°: 'ì›',',' ëª¨ë‘ ì—†ì•°!
      orgPrice = Number(tprice.replace('ì›','').replace(/,/g,''));
      console.log('ì›ë˜ê°€ê²©:',orgPrice);
      // ë¬¸ìì—´.replace(ë°”ê¿€ë†ˆ, ë°”ë€”ë†ˆ)

      // ê°œìˆ˜ ì´ˆê¸°í™”
      sum.val('1');

    }); /////////// click //////////////



  }, ///// mounted ///////////
}); //////// win-comp ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ///////////

